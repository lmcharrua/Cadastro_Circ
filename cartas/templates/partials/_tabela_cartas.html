<table class="table-auto w-full border">
  <thead>
    <tr class="bg-gray-100 text-left">
      {% for col, field in columns %}
      <th class="px-2 py-1">
        <button
          type="button"
          class="font-semibold hover:underline"
          hx-get="{% url 'lista_cartas' %}"
          hx-include="#cartas-form"
          hx-target="#tabela_cartas"
          hx-push-url="true"
          hx-vals='{"sort": "{{ field }}", "direction": "{% if sort == field and direction == "asc" %}desc{% else %}asc{% endif %}"}'
        >
          {{ col }}
          {% if sort == field %}
            {% if direction == "asc" %}▲{% else %}▼{% endif %}
          {% endif %}
        </button>
      </th>
      {% endfor %}
    </tr>

    <!-- Per-column search -->
    <tr>
      {% for col, field in columns %}
      <th>
        <input
          type="text"
          name="{{ field }}"
          value="{{ request.field }}"
          placeholder="Search..."
          class="border rounded w-full px-1 py-0.5 text-sm"
          hx-trigger="keyup changed delay:500ms"
        >
      </th>
      {% endfor %}
    </tr>
  </thead>

  <tbody>
    {% for carta in page_obj %}
    <tr class="border-b hover:bg-green-100">
      <td><a href="{% url 'editar_carta' carta.id %}" class="text-blue-600 underline">{{ carta.serial_number }}</a></td>
      <td>{{ carta.part_number }}</td>
      <td>{{ carta.fabricante }}</td>
      <td>{{ carta.sistema }}</td>
      <td>{{ carta.b_type }}</td>
      <td>{{ carta.descricao }}</td>
      <td>{{ carta.estado }}</td>
      <td>{{ carta.localizacao }}</td>
      <td>{{ carta.equipamento }}</td>
    </tr>
    {% empty %}
    <tr><td colspan="9" class="text-center text-gray-500 py-4">No results found</td></tr>
    {% endfor %}
  </tbody>
</table>

<!-- Pagination -->
<div class="mt-3 flex justify-center space-x-2">
  {% if page_obj.has_previous %}
  <button
    type="button"
    hx-get="{% url 'lista_cartas' %}?page={{ page_obj.previous_page_number }}"
    hx-include="#cartas-form"
    hx-target="#tabela_cartas"
    hx-push-url="true"
    class="px-2 py-1 border rounded"
  >
    Prev
  </button>
  {% endif %}

  <span class="px-2 py-1">
    Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}
  </span>

  {% if page_obj.has_next %}
  <button
    type="button"
    hx-get="{% url 'lista_cartas' %}?page={{ page_obj.next_page_number }}"
    hx-include="#cartas-form"
    hx-target="#tabela_cartas"
    hx-push-url="true"
    class="px-2 py-1 border rounded"
  >
    Next
  </button>
  {% endif %}
</div>
